基于HBuilder X软件开发。
从“环境数据监测采集系统”APP修改成“新风系统”APP，目前已完全迁移成功，但部分需要优化。
# 智能新风系统 APP

这是一个基于 uni-app 和 OneNET 物模型平台开发的智能新风系统移动端APP。

本项目基于 HBuilder X 开发，实现了对“中央控制主机”和多个“分布式新风机”的实时监控与远程控制，并提供了强大的历史数据可视化分析功能。

## 📸 APP 界面

<p align="center">
  <img src="https://via.placeholder.com/300x650.png?text=标签页1+智能控制" alt="标签页1-智能控制" width="300"/>
  <img src="https://via.placeholder.com/300x650.png?text=标签页2+数据汇总" alt="标签页2-数据汇总" width="300"/>
</p>

## ✨ 主要功能

APP 采用双标签页（TabBar）布局，功能划分清晰：

### 标签页 1：智能控制 (实时监控与操作)

* **实时数据监控：**
    * **中央控制主机：** 实时显示主机的温度、湿度、PM2.5、甲醛、烟雾、燃气等核心参数。
    * **分布式新风机：** 实时显示 **新风机①、②、③** 各自的环境数据（温度、湿度、烟雾、CO、AQI）。
* **远程下发控制：**
    * **全局模式：** 可一键设置所有设备的全局工作模式（自动 / 手动 / 睡眠）。
    * **独立风速调节：** 可通过滑块（Slider）独立控制每一台新风机（①、②、③）的0-100%风速。

### 标签页 2：数据汇总 (历史数据分析)

采用“**统一Tab，双图表联动**”方案，提供强大的数据对比与分析能力：

* **1. 统一数据单位Tab：**
    * 整个页面由一个统一的分段器控制，按数据单位（**温度、湿度、PM2.5、甲醛、烟雾、AQI/CO**）分组。
    * 点击任一Tab（如“温度”），下方的两个图表会**同时联动更新**，显示该单位下的所有数据。
    * **（已修复BUG）** 彻底修复了之前版本中“Tab点击无效”的问题。

* **2. 24小时平均值 (uCharts 柱状图)：**
    * **对比式柱状图：** 替代了原有的丑陋表格。当点击“温度”Tab时，此图表会显示4根柱子，直观对比“主机”、“新风机①”、“新风机②”、“新风机③”的24小时平均温度。
    * **（已修复BUG）智能平均值：** 修复了数据偏低的问题。计算逻辑**已过滤所有`0`值数据**，仅对有效数据点进行平均（`sum / validList.length`），确保数据准确性。
    * **（已修复BUG）数据格式化：** 修复了 `25.8039...` 的问题，所有平均值均被格式化为一位小数后显示。

* **3. 24小时历史曲线 (uCharts 曲线图)：**
    * **多设备曲线对比：** 完美实现“一个图表显示多个参数”的需求。当点击“温度”Tab时，此图表会在同一坐标系下绘制**4条**对比曲线。
    * **（已修复BUG）`0`值直线修复：** 修复了 `f4ba9cce3b02a3b3f3e714834a5ed55e.jpg` 中`0`值直线的问题。所有`0`值数据点均被替换为`null`，在图表上正确显示为“断线”。

## 🏛️ 系统架构

本项目采用 App - Cloud - Device 架构：

1.  **APP (本项目):**
    * 基于 `uni-app` (Vue 2) 框架开发。
    * 使用 `key.js` 中的 `createCommonToken` 方法生成动态鉴权 `Token`。
    * 通过 `uni.request` 调用 OneNET API。
2.  **Cloud (OneNET 平台):**
    * 使用**物模型 (Thing Model)** 定义设备属性 (`sMFCi53wHH.json`)。
    * 提供物模型相关API（`query-device-property`, `set-device-property`, `query-device-property-history`）进行数据交互。
3.  **Device (硬件):**
    * **中央控制主机**
    * **分布式新风机 (①, ②, ③)**

## 🚀 快速开始

1.  克隆或下载本仓库。
2.  使用 HBuilder X 导入本项目。
3.  在 HBuilder X 中安装 `uCharts` 图表插件（如未自动导入）。
4.  **配置 OneNET 凭证：**
    * 打开 `key.js`，修改 `params` 对象中的 `author_key` 和 `user_id` 为您自己的 OneNET 平台鉴权信息。
    * 打开 `pages/detail/detail.vue` 和 `pages/summary/summary.vue`，修改 `data()` 中的 `PROID` 和 `DEVICE_NAME` 为您自己的产品ID和设备名称。
5.  运行到模拟器或真机（推荐真机调试，以确保网络请求正常）。

## 🛠️ 技术栈

* **uni-app:** 跨平台应用框架 (基于 Vue.js 2)
* **HBuilder X:** 官方开发 IDE
* **OneNET (中国移动物联网平台):** 提供后端云服务和物模型 API
* **uCharts:** 高性能跨端图表库（用于绘制柱状图和曲线图）
